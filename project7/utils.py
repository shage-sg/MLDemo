# -*- coding: utf-8 -*-import numpy as npimport sysimport osdef combine_stopwords(rootpath='./stopwords'):    stopwords = set()    for file in os.listdir(rootpath):        if not file.endswith('.txt'):            continue                with open(os.path.join(rootpath, file), 'r') as fh:            s = fh.readlines()        s = [item.strip() for item in s]                stopwords = stopwords.union(s)    return stopwords    def confusion_matrix(pred, label):    TP = np.logical_and(pred == 1, label == 1).sum()    FP = np.logical_and(pred == 1, label == 0).sum()    FN = np.logical_and(pred == 0, label == 1).sum()    TN = np.logical_and(pred == 0, label == 0).sum()    return TP, FP, TN, FNdef classification_metric(pred, label):    TP, FP, TN, FN = confusion_matrix(pred, label)    sample_size = pred.shape[0]    accuracy = (TP + TN) / sample_size    precision = TP / (TP + FP + sys.float_info.epsilon)    recall = TP / (TP + FN + sys.float_info.epsilon)    F1 = 2 * precision * recall / (precision + recall + sys.float_info.epsilon)    return accuracy, precision, recall, F1